/*
 * CPASSREF/ntt.h
 *
 *  Copyright 2013 John M. Schanck
 *
 *  This file is part of CPASSREF.
 *
 *  CPASSREF is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  CPASSREF is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with CPASSREF.  If not, see <http://www.gnu.org/licenses/>.
*/

/* Dependencies:
      constants.h pass_types.h
*/

#ifndef CPASSREF_EVAL_H_
#define CPASSREF_EVAL_H_

#define NTT_LEN (PASS_N-1)

static const int64 perm[NTT_LEN + 1] = {
#if PASS_N == 433
        2,7,11,21,25,29,31,32,34,41,42,43,45,47,49,53,54,56,57,61,64,65,67,72,73,75,76,78,80,85,87,90,91,93,94,96,98,99,100,101,103,104,106,107,108,110,111,112,114,115,119,120,121,123,126,130,133,135,136,137,139,143,144,146,152,153,155,156,157,158,159,162,163,164,165,166,167,168,170,171,175,177,178,179,181,184,189,190,191,193,194,196,199,201,203,205,208,209,211,213,220,222,224,225,228,230,232,234,237,239,240,242,243,244,249,252,254,255,256,258,262,263,265,266,267,268,269,270,271,274,275,276,277,278,280,281,287,289,290,294,296,297,298,300,303,307,310,312,313,314,318,319,321,322,323,325,326,327,329,330,332,333,334,335,337,339,340,342,343,346,348,353,355,357,358,360,361,366,368,369,372,376,377,379,380,384,386,388,390,391,392,399,401,402,404,408,412,422,426,431,1
#endif

#if PASS_N == 577
        1,2,3,7,9,10,12,15,16,18,19,23,25,27,29,30,32,33,34,36,46,47,49,50,51,53,54,55,57,58,59,65,66,67,68,70,71,74,79,80,81,83,85,86,87,88,90,92,93,95,97,98,102,105,106,108,110,112,116,121,123,126,127,128,132,134,135,137,140,141,144,145,147,149,151,152,154,156,157,158,159,160,163,165,166,167,168,170,172,174,177,182,183,185,187,188,190,191,193,196,198,199,203,212,213,214,215,216,218,219,221,225,227,232,236,240,242,245,246,247,248,249,251,253,257,258,260,262,263,267,268,269,272,274,276,277,279,280,286,288,289,291,297,298,300,301,303,305,308,309,310,314,315,317,319,320,324,326,328,329,330,331,332,335,337,341,345,350,352,356,358,359,361,362,363,364,365,374,378,379,381,384,386,387,389,390,392,394,395,400,403,405,407,409,410,411,412,414,417,418,419,420,421,423,425,426,428,430,432,433,436,437,440,442,443,445,449,450,451,454,456,461,465,467,469,471,472,475,479,480,482,484,485,487,489,490,491,492,494,496,497,498,503,506,507,509,510,511,512,518,519,520,522,523,524,526,527,528,530,531,541,543,544,545,547,548,550,552,554,558,559,561,562,565,567,568,570,574,575,576,1
#endif
#if PASS_N == 769
        1, 70, 286, 26, 282, 515, 676, 411, 317, 658, 689, 552, 190, 227, 510, 326, 519, 187, 17, 421, 248, 442, 180,
        296, 726, 66, 6, 420, 178, 156, 154, 14, 211, 159, 364, 103, 289, 236, 371, 593, 753, 418, 38, 353, 102, 219,
        719, 345, 311, 238, 511, 396, 36, 213, 299, 167, 155, 84, 497, 185, 646, 618, 196, 647, 688, 482, 673, 201, 228,
        580, 612, 545, 469, 532, 328, 659, 759, 69, 216, 509, 256, 233, 161, 504, 675, 341, 31, 632, 407, 37, 283, 585,
        193, 437, 599, 404, 596, 194, 507, 116, 430, 109, 709, 414, 527, 747, 767, 629, 197, 717, 205, 508, 186, 716,
        135, 222, 160, 434, 389, 315, 518, 117, 500, 395, 735, 696, 273, 654, 409, 177, 86, 637, 757, 698, 413, 457,
        461, 741, 347, 451, 41, 563, 191, 297, 27, 352, 32, 702, 693, 63, 565, 331, 100, 79, 147, 293, 516, 746, 697,
        343, 171, 435, 459, 601, 544, 399, 246, 302, 377, 244, 162, 574, 192, 367, 313, 378, 314, 448, 600, 474, 113,
        220, 20, 631, 337, 520, 257, 303, 447, 530, 188, 87, 707, 274, 724, 695, 203, 368, 383, 664, 340, 730, 346, 381,
        524, 537, 678, 551, 120, 710, 484, 44, 4, 280, 375, 104, 359, 522, 397, 106, 499, 325, 449, 670, 760, 139, 502,
        535, 538, 748, 68, 146, 223, 230, 720, 415, 597, 264, 24, 142, 712, 624, 616, 56, 75, 636, 687, 412, 387, 175,
        715, 65, 705, 134, 152, 643, 408, 107, 569, 611, 475, 183, 506, 46, 144, 83, 427, 668, 620, 336, 450, 740, 277,
        165, 15, 281, 445, 390, 385, 35, 143, 13, 141, 642, 338, 590, 543, 329, 729, 276, 95, 498, 255, 163, 644, 478,
        393, 595, 124, 221, 90, 148, 363, 33, 3, 210, 89, 78, 77, 7, 490, 464, 182, 436, 529, 118, 570, 681, 761, 209,
        19, 561, 51, 494, 744, 557, 540, 119, 640, 198, 18, 491, 534, 468, 462, 42, 633, 477, 323, 309, 98, 708, 344,
        241, 721, 485, 114, 290, 306, 657, 619, 266, 164, 714, 764, 419, 108, 639, 128, 501, 465, 252, 722, 555, 400,
        316, 588, 403, 526, 677, 481, 603, 684, 202, 298, 97, 638, 58, 215, 439, 739, 207, 648, 758, 768, 699, 483, 743,
        487, 254, 93, 358, 452, 111, 80, 217, 579, 542, 259, 443, 250, 582, 752, 348, 521, 327, 589, 473, 43, 703, 763,
        349, 591, 613, 615, 755, 558, 610, 405, 666, 480, 533, 398, 176, 16, 351, 731, 416, 667, 550, 50, 424, 458, 531,
        258, 373, 733, 556, 470, 602, 614, 685, 272, 584, 123, 151, 573, 122, 81, 287, 96, 568, 541, 189, 157, 224, 300,
        237, 441, 110, 10, 700, 553, 260, 513, 536, 608, 265, 94, 428, 738, 137, 362, 732, 486, 184, 576, 332, 170, 365,
        173, 575, 262, 653, 339, 660, 60, 355, 242, 22, 2, 140, 572, 52, 564, 261, 583, 53, 634, 547, 609, 335, 380,
        454, 251, 652, 269, 374, 34, 73, 496, 115, 360, 592, 683, 132, 12, 71, 356, 312, 308, 28, 422, 318, 728, 206,
        578, 472, 742, 417, 737, 67, 76, 706, 204, 438, 669, 690, 622, 476, 253, 23, 72, 426, 598, 334, 310, 168, 225,
        370, 523, 467, 392, 525, 607, 195, 577, 402, 456, 391, 455, 321, 169, 295, 656, 549, 749, 138, 432, 249, 512,
        466, 322, 239, 581, 682, 62, 495, 45, 74, 566, 401, 386, 105, 429, 39, 423, 388, 245, 232, 91, 218, 649, 59,
        285, 725, 765, 489, 394, 665, 410, 247, 372, 663, 270, 444, 320, 99, 9, 630, 267, 234, 231, 21, 701, 623, 546,
        539, 49, 354, 172, 505, 745, 627, 57, 145, 153, 713, 694, 133, 82, 357, 382, 594, 54, 704, 64, 635, 617, 126,
        361, 662, 200, 158, 294, 586, 263, 723, 625, 686, 342, 101, 149, 433, 319, 29, 492, 604, 754, 488, 324, 379,
        384, 734, 626, 756, 628, 127, 431, 179, 226, 440, 40, 493, 674, 271, 514, 606, 125, 291, 376, 174, 645, 548,
        679, 621, 406, 736, 766, 559, 680, 691, 692, 762, 279, 305, 587, 333, 240, 651, 199, 88, 8, 560, 750, 208, 718,
        275, 25, 212, 229, 650, 129, 571, 751, 278, 235, 301, 307, 727, 136, 292, 446, 460, 671, 61, 425, 528, 48, 284,
        655, 479, 463, 112, 150, 503, 605, 55, 5, 350, 661, 130, 641, 268, 304, 517, 47, 214, 369, 453, 181, 366, 243,
        92, 288, 166, 85, 567, 471, 672, 131, 711, 554, 330, 30, 562, 121, 11, 1
#endif
#if PASS_N == 1153
        2,3,4,5,7,8,10,17,19,21,22,26,28,29,30,31,32,33,38,39,40,41,42,45,46,48,49,51,55,57,58,60,62,64,65,66,67,68,70,72,74,76,77,78,80,82,83,85,86,87,88,89,93,102,103,105,108,109,110,112,113,114,115,116,117,118,120,121,122,124,125,127,131,134,135,137,138,142,143,146,147,149,151,153,156,157,159,161,166,167,168,169,170,173,175,185,186,189,192,195,197,198,200,202,203,204,205,206,208,209,210,211,212,213,214,215,218,219,220,222,226,228,234,237,238,239,241,242,243,245,248,249,250,253,255,256,257,261,263,265,267,269,270,271,275,277,278,280,281,282,284,285,288,289,290,292,293,296,299,300,301,302,303,306,307,308,309,311,315,317,318,321,323,324,325,327,328,329,330,331,335,336,338,339,341,346,348,350,351,352,354,358,360,363,364,368,369,370,374,375,377,378,382,389,391,392,393,394,396,397,402,403,405,406,408,409,411,414,415,417,419,422,425,427,431,435,437,438,440,442,443,444,446,447,451,454,455,456,458,459,460,468,470,471,472,473,476,478,479,481,484,485,487,488,492,493,497,499,502,503,506,507,508,509,512,513,515,516,518,522,523,527,529,530,532,533,535,536,539,543,544,546,547,548,551,553,554,555,556,557,561,562,563,567,568,570,571,573,575,576,577,578,580,582,583,585,586,590,591,592,596,597,598,599,600,602,605,606,607,609,610,614,617,618,620,621,623,624,626,630,631,635,637,638,640,641,644,645,646,647,650,651,654,656,660,661,665,666,668,669,672,674,675,677,680,681,682,683,685,693,694,695,697,698,699,702,706,707,709,710,711,713,715,716,718,722,726,728,731,734,736,738,739,742,744,745,747,748,750,751,756,757,759,760,761,762,764,771,775,776,778,779,783,784,785,789,790,793,795,799,801,802,803,805,807,812,814,815,817,818,822,823,824,825,826,828,829,830,832,835,836,838,842,844,845,846,847,850,851,852,853,854,857,860,861,863,864,865,868,869,871,872,873,875,876,878,882,883,884,886,888,890,892,896,897,898,900,903,904,905,908,910,911,912,914,915,916,919,925,927,931,933,934,935,938,939,940,941,942,943,944,945,947,948,949,950,951,953,955,956,958,961,964,967,968,978,980,983,984,985,986,987,992,994,996,997,1000,1002,1004,1006,1007,1010,1011,1015,1016,1018,1019,1022,1026,1028,1029,1031,1032,1033,1035,1036,1037,1038,1039,1040,1041,1043,1044,1045,1048,1050,1051,1060,1064,1065,1066,1067,1068,1070,1071,1073,1075,1076,1077,1079,1081,1083,1085,1086,1087,1088,1089,1091,1093,1095,1096,1098,1102,1104,1105,1107,1108,1111,1112,1113,1114,1115,1120,1121,1122,1123,1124,1125,1127,1131,1132,1134,1136,1143,1145,1146,1148,1149,1150,1151,1
#endif
};

int ntt_setup();

int ntt_cleanup();

int ntt(int64 *wS, const int64 *w);

#endif
